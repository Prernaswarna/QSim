%     qubit	q0
%     qubit	q1
%     qubit	q2
%     qubit	q3
% 
%     h	q0
%     h	q1
%     h	q2
%     h	q3
%     dmeter	q0
%     dmeter	q1
%     dmeter	q2
%     dmeter	q3

%  Time 01:
%    Gate 00 h(q0)
%    Gate 01 h(q1)
%    Gate 02 h(q2)
%    Gate 03 h(q3)
%  Time 02:
%    Gate 04 dmeter(q0)
%    Gate 05 dmeter(q1)
%    Gate 06 dmeter(q2)
%    Gate 07 dmeter(q3)

% Qubit circuit matrix:
%
% q0: gAxA, gBxA, N  
% q1: gAxB, gBxB, N  
% q2: gAxC, gBxC, N  
% q3: gAxD, gBxD, N  

\documentclass[11pt]{article}
\input{xyqcirc.tex}

% definitions for the circuit elements

\def\gAxA{\op{H}\w\A{gAxA}}
\def\gAxB{\op{H}\w\A{gAxB}}
\def\gAxC{\op{H}\w\A{gAxC}}
\def\gAxD{\op{H}\w\A{gAxD}}
\def\gBxA{\dmeter{}\w\A{gBxA}}
\def\gBxB{\dmeter{}\w\A{gBxB}}
\def\gBxC{\dmeter{}\w\A{gBxC}}
\def\gBxD{\dmeter{}\w\A{gBxD}}

% definitions for bit labels and initial states

\def\bA{ \q{q_{0}}}
\def\bB{ \q{q_{1}}}
\def\bC{ \q{q_{2}}}
\def\bD{ \q{q_{3}}}

% The quantum circuit as an xymatrix

\xymatrix@R=5pt@C=10pt{
    \bA & \gAxA &\gBxA &\N  
\\  \bB & \gAxB &\gBxB &\N  
\\  \bC & \gAxC &\gBxC &\N  
\\  \bD & \gAxD &\gBxD &\N  
%
% Vertical lines and other post-xymatrix latex
%
}

\end{document}
